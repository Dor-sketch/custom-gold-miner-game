<!DOCTYPE html>
<html lang="en-us">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T7HFKFX0PR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-T7HFKFX0PR');
    </script>
    <!-- End Google tag (gtag.js) -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiriMiner: Raiders of the Lost Ark by Dor</title>
    <meta name="description"
        content="Throw Miri's hook to collect the treasures and earn points while avoiding rocks!!">
    <meta name="keywords"
        content="gold miner, game, MiriMiner, Raiders of the Lost Ark, Dor Pascal, מירי רגב, בנימין נתניהו, משחק, כור הזהב">
    <meta name="author" content="Dor Pascal">
    <meta name="robots" content="index, follow">
    <meta name="revisit-after" content="3 months">
    <meta name="language" content="en_US">
    <meta name="generator" content="Visual Studio Code">
    <meta name="distribution" content="global">
    <meta name="rating" content="general">

    <meta property="og:title" content="MiriMiner: Raiders of the Lost Ark by Dor">
    <meta property="og:description"
        content="Throw Miri's hook to collect the treasures and earn points while avoiding rocks!!">
    <meta property="og:url" content="https://dorpascal.com/custom-gold-miner-game/">
    <meta property="og:site_name" content="Dor Pascal">
    <meta property="og:image" content="https://img.itch.zone/aW1nLzE2NDk5MDIwLnBuZw==/original/2yX8O8.png">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="he_IL">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="og:image" content="https://dorpascal.com/custom-gold-miner-game/images/miriminer.gif">

    <meta name="theme-color" content="#3f2832">
    <link rel="icon" href="https://img.itch.zone/aW1nLzE2NTI1MjM3LnBuZw==/32x32%23/2iSy7o.png" type="image/png">
    <link href="https://static.itch.io/game.css?1720118245" rel="stylesheet">
    <link href="https://static.itch.io/redactor.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #3f2832;
            color: #ffe762;
            margin: 0;
            padding: 0;
        }

        .wrapper {
            max-width: 1000px;
            margin: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        header h1 {
            background: -webkit-linear-gradient(right, red, yellow);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.5em;
            margin-bottom: 0;
        }
        .instructions {
            background-color: rgba(63, 40, 50, 0.85);
            padding: 40px;
            border-radius: 10px;
            margin-top: 20px;
            margin-bottom: 20px; /* Ensure consistent margin around the box */
            margin-left: auto;
            margin-right: auto;
            max-width: 600px; /* Adjust this value to control the maximum width */
        }

        .instructions h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .instructions p {
            margin: 5px 0;
        }

        .gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }

        .gallery img {
            width: 48%;
            /* border: 2px solid #694957; */
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9em;
        }

        #top-scores h2 {
            background: -webkit-linear-gradient(right, red, yellow);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2em;
            margin-bottom: 20px;
        }
        #scores {
            color: #3f2832;
            border: 2px solid gold;
            padding: 20px;
            background-color: #f9f9f9;
            min-height: 200px;
            /* Removed flex display properties */
            gap: 10px;
        }

        #scores:empty::before {
            content: 'Loading top scores...';
            color: #3f2832;
        }

        #top-scores button {
            background-color: gold;
            color: white;
            border: none;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
        }

        #top-scores button:hover {
            background-color: white;
            color: gold;
            border: 2px solid gold;
        }

        .bubble {
            position: fixed;
            bottom: 0;
            background-color: gold;
            border-radius: 50%;
            animation-name: bubble;
            animation-timing-function: linear;
        }

        @keyframes bubble {
            0% {
                transform: translateY(0);
            }

            100% {
                transform: translateY(-100vh);
            }
        }

        .container iframe {
            width: 900px;
            height: 600px;
        }

        .instructions_and_topscores {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
    </style>
</head>

<body>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
        import { getFirestore, collection, query, orderBy, limit, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDr3oTDvPzkzTBQhvwiQimaZ9iZl4ivTVI",
            authDomain: "miri-miner.firebaseapp.com",
            projectId: "miri-miner",
            storageBucket: "miri-miner.appspot.com",
            messagingSenderId: "727472014008",
            appId: "1:727472014008:web:aefc3173c2625b1c3baa4d",
            measurementId: "G-LQ3XPF6GMC"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function getTopScores() {
            console.log("Hello World");

            const q = query(collection(db, 'scores'), orderBy('score', 'desc'), limit(10));
            const querySnapshot = await getDocs(q);

            const topScores = querySnapshot.docs.map((doc, index) => {
                return { rank: index + 1, player: doc.data().player, score: doc.data().score };
            });
            // Store the top scores in local storage
            localStorage.setItem('topScores', JSON.stringify(topScores));
            return topScores;
        }

        getTopScores().then(topScores => {
            console.log(topScores);
            const scoresElement = document.getElementById('scores');
            let tableHTML = '<table style="width: 100%;">';
            tableHTML += '<tr><th>Rank</th><th>Name</th><th>Score</th></tr>'; // Table headers
            topScores.forEach(({ rank, player, score }) => {
                tableHTML += `<tr>
                                <td style="text-align: left;">${rank}</td>
                                <td style="text-align: left;">${player}</td>
                                <td style="text-align: right;">${score}</td>
                              </tr>`;
            });
            tableHTML += '</table>';
            scoresElement.innerHTML = tableHTML;
        }).catch(error => {
            console.error('Error getting top scores: ', error);
        });
        async function saveScore(player, score) {
            if (!player) {
                return;
            }

            try {
                await addDoc(collection(db, 'scores'), {
                    player: player,
                    score: score
                });
                console.log('Score saved successfully');
            } catch (error) {
                console.error('Error saving score: ', error);
            }
        }
        async function checkScore() {
            let end = localStorage.getItem('end');
            while (end === null || end === 'false') {
                await new Promise(resolve => setTimeout(resolve, 1000)); // Wait for 1 second
                end = localStorage.getItem('end');
            }
            if (end === 'true') {
                // set back to false to prevent multiple calls
                localStorage.setItem('end', 'false');
                let score = localStorage.getItem('score');
                let player;
                if (score !== null) {
                    score = Number(score);
                    if (score < 0) {
                        // Once the score is negative, prompt the user for their name
                        player = prompt('Enter your name if you want to save your terrible score:' + end);
                    }
                    if (score > 0) {
                        // Once the score is positive, prompt the user for their name
                        player = prompt('Nice score! Enter your name to save it:');
                    }
                    // Save the score to Firestore
                    saveScore(player, score);
                }
            }
        }
        checkScore();
    </script>

    <div class="wrapper">
        <header>
            <h1>MiriMiner: Raiders of the Lost Ark</h1>
        </header>
        <div class="container">
            <iframe src="game.html" frameborder="0"></iframe>
        </div>
        <div class="instructions_and_topscores">
        <div class="instructions">
            <h1>MiriMiner: Raiders of the Lost Ark</h1>
            <p>An implementation of the classic Gold Miner game using Python and Pygame.
            </p>
            <p>Features include:<br></p>
            <ul>
                <li>Real-time game dynamics with gold and rock objects to be mined.</li>
                <li>Dynamic background and object image loading.</li>
                <li>Interactive gameplay with swinging and retracting mechanisms.</li>
                <li>Scorekeeping and object interaction (grabbing and
                    carrying).<strong></strong><strong></strong><strong><br></strong></li>
            </ul>
            <h2>Instructions</h2>
            <p>Throw Miri's hook to collect the treasures and earn points while avoiding rocks!!</p>
            <blockquote>
                <strong>iPhone Users:</strong>&nbsp;When the screen finishes loading and you see the message "Ready to
                start!", tap on the lighter grey areas (either above or below the darker area in the center of the
                screen) to begin.
            </blockquote>
        </div>
        <div id="top-scores">
            <h2>Top Scores</h2>
            <div id="scores"></div>
            <button onclick="createGoldBubble()">Reload</button>
        </div>
        </div>
        <div class="links">
            <h2>Miriminer also available on the leading game platform:</h2>
            <iframe frameborder="0" src="https://itch.io/embed/2759175?dark=true" width="552" height="167"><a
                    href="https://dor-sketch.itch.io/miriminer">MiriMiner: Raiders of the Lost Ark by Dor</a></iframe>
        </div>
        <div class="gallery">
            <img src="https://img.itch.zone/aW1hZ2UvMjc1OTE3NS8xNjUyNTAzNi5wbmc=/original/y4VS5r.png"
                alt="Screenshot 1">
            <img src="https://img.itch.zone/aW1hZ2UvMjc1OTE3NS8xNjUyNTAyNS5wbmc=/original/%2BgIWyj.png"
                alt="Screenshot 2">
            <img src="https://img.itch.zone/aW1hZ2UvMjc1OTE3NS8xNjUyNTAxOC5wbmc=/original/QE25Tg.png"
                alt="Screenshot 3">
            <img src="https://img.itch.zone/aW1hZ2UvMjc1OTE3NS8xNjUyNTA2Mi5wbmc=/original/7Zf0UF.png"
                alt="Screenshot 4">
        </div>
        <div class="footer">
            &copy; 2024 MiriMiner. All rights reserved. | <a href="https://dorpascal.com"> dorpascal.com</a>
        </div>
    </div>

    <script>
        function createGoldBubble() {
            var bubble = document.createElement('div');
            bubble.className = 'bubble';
            bubble.style.left = Math.random() * 100 + 'vw';
            bubble.style.width = bubble.style.height = Math.random() * 100 + 'px';
            bubble.style.animationDuration = Math.random() * 3 + 2 + 's';
            document.body.appendChild(bubble);

            setTimeout(function () {
                bubble.remove();
            }, 5000);
        }
        async function getTopScores() {
            const q = query(collection(db, 'scores'), orderBy('score', 'desc'), limit(10));
            const querySnapshot = await getDocs(q);

            let tableHTML = '<table style="width: 100%;">';
            tableHTML += '<tr><th>Rank</th><th>Name</th><th>Score</th></tr>'; // Table headers
            querySnapshot.docs.forEach((doc, index) => {
                const player = doc.data().player;
                const score = doc.data().score;
                tableHTML += `<tr>
                                <td style="text-align: left;">${index + 1}</td>
                                <td style="text-align: left;">${player}</td>
                                <td style="text-align: right;">${score}</td>
                              </tr>`;
            });
            tableHTML += '</table>';

            localStorage.setItem('topScores', JSON.stringify(querySnapshot.docs.map((doc, index) => `${index + 1}. ${doc.data().player}: ${doc.data().score}`)));
            document.getElementById('scores').innerHTML = tableHTML;
            return querySnapshot.docs.map((doc, index) => `${index + 1}. ${doc.data().player}: ${doc.data().score}`);
        }

        async function checkScore() {
            let end = localStorage.getItem('end');
            while (end === null || end === 'false') {
                await new Promise(resolve => setTimeout(resolve, 1000));
                end = localStorage.getItem('end');
            }
            if (end === 'true') {
                localStorage.setItem('end', 'false');
                let score = localStorage.getItem('score');
                let player;
                if (score !== null) {
                    score = Number(score);
                    player = score < 0 ? prompt('Enter your name if you want to save your terrible score:') : prompt('Nice score! Enter your name to save it:');
                    saveScore(player, score);
                }
            }
        }
        document.addEventListener("DOMContentLoaded", function () {
            getTopScores().then(topScores => {
                let tableHTML = '<table style="width: 100%;">';
                tableHTML += '<tr><th>Rank</th><th>Name</th><th>Score</th></tr>'; // Table headers
                topScores.forEach(scoreString => {
                    const [rankAndName, score] = scoreString.split(': ');
                    const [rank, name] = rankAndName.split('. ');
                    tableHTML += `<tr>
                                    <td style="text-align: left;">${rank}</td>
                                    <td style="text-align: left;">${name}</td>
                                    <td style="text-align: right;">${score}</td>
                                  </tr>`;
                });
                tableHTML += '</table>';
                document.getElementById('scores').innerHTML = tableHTML;
            }).catch(error => {
                console.error('Error getting top scores: ', error);
            });

            checkScore();
        });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, query, orderBy, limit, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDr3oTDvPzkzTBQhvwiQimaZ9iZl4ivTVI",
            authDomain: "miri-miner.firebaseapp.com",
            projectId: "miri-miner",
            storageBucket: "miri-miner.appspot.com",
            messagingSenderId: "727472014008",
            appId: "1:727472014008:web:aefc3173c2625b1c3baa4d",
            measurementId: "G-LQ3XPF6GMC"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
    </script>
</body>

</html>